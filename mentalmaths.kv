#:import FadeTransition kivy.uix.screenmanager.FadeTransition

<MenuList>
    id: "MenuList"
    name: "menulist"
    ScrollView:
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        size_hint: (1, 0.9)
        bar_width: 0
        MDBoxLayout:
            adaptive_height: True
            orientation: "vertical"
            pos_hint: {"center_x": 0.5}

            MDBoxLayout:
                padding: "10dp"
                adaptive_size: True
                spacing: "10dp"
                orientation: "vertical"
                pos_hint: {"center_x": 0.5}

                MDBoxLayout:
                    adaptive_width: True
                    size_hint_y: None
                    height: "56dp"
                    spacing: "10dp"
                    pos_hint: {"center_x": .5}

                    MDRaisedButton:
                        text: 'Time Attack: Multiply By 11'
                        pos_hint: {"center_x": 0.5}
                        disabled: app.is_locked_level["Multiply By 11"]
                        on_press:
                            app.root.ids.screen_manager.current = 'pregame'
                            app.set_game("Multiply By 11", "Time Attack")
                            app.launch_game()

                    MDRaisedButton:
                        text: 'Quiz: Multiply By 11'
                        pos_hint: {"center_x": 0.5}
                        disabled: app.is_locked_level["Multiply By 11"]
                        on_press:
                            app.root.ids.screen_manager.current = 'pregame'
                            app.set_game("Multiply By 11", "Timed Quiz")
                            app.launch_game()

                MDBoxLayout:
                    adaptive_width: True
                    size_hint_y: None
                    height: "56dp"
                    spacing: "10dp"
                    pos_hint: {"center_x": .5}

                    MDRaisedButton:
                        text: 'Time Attack: Two digit addition'
                        pos_hint: {"center_x": 0.5}
                        disabled: app.is_locked_level["Two Digit Addition"]
                        on_press:
                            app.root.ids.screen_manager.current = 'pregame'
                            app.set_game("Two Digit Addition", "Time Attack")
                            app.launch_game()

                    MDRaisedButton:
                        text: 'Quiz: Two digit addition'
                        pos_hint: {"center_x": 0.5}
                        disabled: app.is_locked_level["Two Digit Addition"]
                        on_press:
                            app.root.ids.screen_manager.current = 'pregame'
                            app.set_game("Two Digit Addition", "Timed Quiz")
                            app.launch_game()

                MDBoxLayout:
                    adaptive_width: True
                    size_hint_y: None
                    height: "56dp"
                    spacing: "10dp"
                    pos_hint: {"center_x": .5}

                    MDRaisedButton:
                        text: 'Time Attack: Three by one digit multiplication'
                        pos_hint: {"center_x": 0.5}
                        disabled: app.is_locked_level["Three By One Digit Multiplication"]
                        on_press:
                            app.root.ids.screen_manager.current = 'pregame'
                            app.set_game("Three By One Digit Multiplication", "Time Attack")
                            app.launch_game()

                    MDRaisedButton:
                        text: 'Quiz: Three by one digit multiplication'
                        pos_hint: {"center_x": 0.5}
                        disabled: app.is_locked_level["Three By One Digit Multiplication"]
                        on_press:
                            app.root.ids.screen_manager.current = 'pregame'
                            app.set_game("Three By One Digit Multiplication", "Timed Quiz")
                            app.launch_game()

                MDBoxLayout:
                    adaptive_width: True
                    size_hint_y: None
                    height: "56dp"
                    spacing: "10dp"
                    pos_hint: {"center_x": .5}

                    MDRaisedButton:
                        text: 'Time Attack: Two digit multiplication'
                        pos_hint: {"center_x": 0.5}
                        disabled: app.is_locked_level["Two Digit Multiplication"]
                        on_press:
                            app.root.ids.screen_manager.current = 'pregame'
                            app.set_game("Two Digit Multiplication", "Time Attack")
                            app.launch_game()

                    MDRaisedButton:
                        text: 'Quiz: Two digit multiplication'
                        pos_hint: {"center_x": 0.5}
                        disabled: app.is_locked_level["Two Digit Multiplication"]
                        on_press:
                            app.root.ids.screen_manager.current = 'pregame'
                            app.set_game("Two Digit Multiplication", "Timed Quiz")
                            app.launch_game()


<BasicScreen>
    MDToolbar:
        id: toolbar
        pos_hint: {"bottom": 1}
        elevation: 10
        title: "Maths Dojo"
        right_action_items: [["home", lambda x: app.change_screen("home")], ["cog-outline", lambda x: app.change_screen("settings")]]



MDBoxLayout:

    ScreenManager:
        id: screen_manager
        transition: FadeTransition(duration=.2, clearcolor=app.theme_cls.bg_dark)

        BasicScreen:
            id: home
            name: "home"

            MenuList:



        GameScreen:
            id: game_screen
            name: "game_screen"

        BasicScreen:
            id: pregame
            name: "pregame"

            MDBoxLayout:
                pos_hint: {"center_x": 0.5, "center_y": 0.4}
                orientation: "vertical"
                spacing: "50dp"
                adaptive_width: True
                size_hint_y: None

                MDBoxLayout:
                    adaptive_width: True
                    size_hint_y: None
                    StartGameButton:
                        pos_hint: {"center_x": 0.3}
                    HelpButton:
                        pos_hint: {"center_x": 0.5}
                    MenuButton:
                        pos_hint: {"center_x": 0.7}

                MDBoxLayout:
                    adaptive_width: True
                    size_hint_y: None
                    orientation: "vertical"
                    ChallengeLabel:
                        text: app.challenge_text["gold"]
                        id: gold_challenge_label
                        pos_hint: {"center_x": 0.5}
                        disabled: True

                    ChallengeLabel:
                        text: app.challenge_text["silver"]
                        id: silver_challenge_label
                        pos_hint: {"center_x": 0.5}

                    ChallengeLabel:
                        text: app.challenge_text["bronze"]
                        id: bronze_challenge_label
                        pos_hint: {"center_x": 0.5}

        BasicScreen:
            id: settings
            name: "settings"

            MDLabel:
                pos_hint: {"center_x": .6, "center_y": .8}
                text: "Dark Mode"

            MDSwitch:
                pos_hint: {"center_x": .75, "center_y": .8}
                active: False
                on_active: app.light_dark_switch()

        CountDownScreen:
            id: count_down_screen
            name: "count_down_screen"


<GameScreen>
    id: game_screen

    MDBoxLayout:
        pos_hint: {"center_x": 1, "center_y": 0.95}
        size_hint: 0.3, 0.1
        ClockLabel:
            id: clock_label

    MDBoxLayout:
        MDLabel:
            id: score
            pos_hint: {"center_x": 0.05, "center_y": 0.95}
            size_hint: 0.3, 0.1
            text: "Score: 0"


    AnswerBoxHighlight:
        id: highlight
        animated_color: self.colour
        animated_size: (PlayerInput.size[0]*1.5, PlayerInput.size[1]*1.5)
        pos_hint: PlayerInput.pos_hint

    MDLabel:
        id: prompt
        text: ""
        halign: "center"
        text_color: app.theme_cls.primary_dark
        font_size: 30
        pos_hint: {'center_x': 0.5, 'center_y': 0.6}

    MDTextField:
        id: PlayerInput
        hint_text: "Enter your answer"
        helper_text: ""
        helper_text_mode: "on_focus"
        pos_hint: {'center_x': 0.5, 'center_y': 0.3}
        text_validate_unfocus: False
        on_text_validate:
            app.game.player_input()

<AnswerBoxHighlight>
    animated_color: 0, 0, 0, 0
    blink_size: (0, 0)
    canvas.before:
        Color:
            rgba: self.animated_color
        RoundedRectangle: # center
            size: (root.blink_size[0], root.blink_size[1])
            pos: self.pos[0] + self.size[0]/2. - self.blink_size[0]/2., self.pos[1] + self.size[1]/2. - self.blink_size[1]/2.

<MenuButton>
    text: "Menu"
    text_color: app.theme_cls.primary_color
    on_release:
        app.root.ids.screen_manager.current = "home"
        app.set_game("Maths Dojo", "Maths Dojo")

<PopUpMenuButton>
    text: "Menu"
    text_color: app.theme_cls.primary_color
    on_release:
        app.game.PopUp.dismiss()
        app.root.ids.screen_manager.current = "home"
        app.set_game("Maths Dojo", "Maths Dojo")

<PlayAgainButton>
    text: "Play Again"
    text_color: app.theme_cls.primary_color
    on_release:
        app.game.PopUp.dismiss()
        app.game.start_game()

<HelpButton>
    text: "Help"
    text_color: app.theme_cls.primary_color
    on_release:
        app.game.display_help()

<CloseButton>
    text: "Close"
    text_color: app.theme_cls.primary_color
    on_release:
        app.game.HelpPopUp.dismiss()

<StartGameButton>
    text: "Start Game"
    text_color: app.theme_cls.primary_color
    on_release:
        app.game.start_game()

<ClockLabel>
    text: "This shouldn't be here"
    pos_hint: {"center_x": 0.5, "center_y": 0.5}
    size_hint: 1, 1
    font_size: 25
    color: app.theme_cls.primary_color

<CountDownScreen>
    MDLabel:
        id: count_down
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        size_hint: 0.1, 0.1
        font_size: 100
        color: app.theme_cls.primary_color
        text: "3"

<ChallengeLabel>
    icon: "medal-outline"
    line_color_disabled: (0, 0, 0, 0)
    line_color: (0, 0, 0, 0)
    ripple_scale: 0
